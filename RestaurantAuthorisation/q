-- H2 2.1.214;
SET DB_CLOSE_DELAY -1;        
;             
CREATE USER IF NOT EXISTS "SA" SALT 'cd08ba8e92aca73a' HASH '436be19f6fe9249c5fa830a47b80bc5a1b699f1a4423a6eccaefcd79d245f161' ADMIN;         
CREATE SEQUENCE "PUBLIC"."SESSION_SEQ" START WITH 1 INCREMENT BY 50;          
CREATE SEQUENCE "PUBLIC"."USER_SEQ" START WITH 1 INCREMENT BY 50;             
CREATE MEMORY TABLE "PUBLIC"."SESSION"(
    "EXPIRES_AT" TIMESTAMP(6) NOT NULL,
    "ID" BIGINT NOT NULL,
    "USER_ID" BIGINT,
    "SESSION_TOKEN" CHARACTER VARYING(255) NOT NULL
);   
ALTER TABLE "PUBLIC"."SESSION" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_A" PRIMARY KEY("ID");      
-- 0 +/- SELECT COUNT(*) FROM PUBLIC.SESSION; 
CREATE MEMORY TABLE "PUBLIC"."USER"(
    "CREATED_AT" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "ID" BIGINT NOT NULL,
    "UPDATED_AT" TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    "EMAIL" CHARACTER VARYING(255) NOT NULL,
    "PASSWORD_HASH" CHARACTER VARYING(255) NOT NULL,
    "ROLE" CHARACTER VARYING(255) NOT NULL,
    "USERNAME" CHARACTER VARYING(255) NOT NULL
);
ALTER TABLE "PUBLIC"."USER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_27" PRIMARY KEY("ID");        
-- 0 +/- SELECT COUNT(*) FROM PUBLIC."USER";  
ALTER TABLE "PUBLIC"."USER" ADD CONSTRAINT "PUBLIC"."CONSTRAINT_2" CHECK("ROLE" IN('customer', 'chef', 'manager')) NOCHECK;   
ALTER TABLE "PUBLIC"."USER" ADD CONSTRAINT "PUBLIC"."UKSB8BBOUER5WAK8VYIIY4PF2BX" UNIQUE("USERNAME");         
ALTER TABLE "PUBLIC"."USER" ADD CONSTRAINT "PUBLIC"."UKOB8KQYQQGMEFL0ACO34AKDTPE" UNIQUE("EMAIL");            
ALTER TABLE "PUBLIC"."SESSION" ADD CONSTRAINT "PUBLIC"."FK1BI1PMQJGIPW7DX3J6BL37DJA" FOREIGN KEY("USER_ID") REFERENCES "PUBLIC"."USER"("ID") NOCHECK;         
